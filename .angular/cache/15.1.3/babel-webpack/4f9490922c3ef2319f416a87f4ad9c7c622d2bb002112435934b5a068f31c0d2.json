{"ast":null,"code":"import { Pessoa } from 'src/app/shared/model/pessoa.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./../oficio.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"./../../service/mensagemService\";\nimport * as i4 from \"src/app/service/file.service\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"primeng/api\";\nimport * as i7 from \"primeng/dropdown\";\nimport * as i8 from \"primeng/calendar\";\nimport * as i9 from \"primeng/button\";\nimport * as i10 from \"primeng/editor\";\nimport * as i11 from \"primeng/inputtext\";\nimport * as i12 from \"primeng/tabview\";\nimport * as i13 from \"ng2-pdf-viewer\";\nconst _c0 = function () {\n  return {\n    \"width\": \"400px\"\n  };\n};\nconst _c1 = function () {\n  return {\n    \"height\": \"120px\",\n    \"font-size\": \"16px\"\n  };\n};\nexport class OficioFormComponent {\n  constructor(oficioService, router, mensagemService, activedRoute, fileService) {\n    this.oficioService = oficioService;\n    this.router = router;\n    this.mensagemService = mensagemService;\n    this.activedRoute = activedRoute;\n    this.fileService = fileService;\n    this.titulo = 'Cadastrar ofício';\n    this.oficio = {\n      assinante: new Pessoa(),\n      texto: '',\n      assunto: '',\n      numero: '',\n      dataOficio: new Date(),\n      destinatario: '',\n      cargoDestinatario: '',\n      formaTratamentoDestinatario: ''\n    };\n    this.pdfSrc = '';\n  }\n  ngOnInit() {\n    this.listarVereadores();\n    this.oficioId = this.activedRoute.snapshot.paramMap.get('id');\n    if (this.oficioId !== null) {\n      this.titulo = 'Editar ofício';\n      this.findById(+this.oficioId);\n    }\n  }\n  listarVereadores() {\n    this.oficioService.listarAssinantes().subscribe(response => {\n      this.assinanteList = response;\n    }, error => {\n      this.mensagemService.mensagemError(error, 'Ocorreu um erro ao tentar listar os assinantes!');\n    });\n  }\n  cadastrar() {\n    if (this.validaCampos()) {\n      this.oficioService.cadastrar(this.oficio).subscribe(() => {\n        this.mensagemService.mensagemSucesso('Cadastro realizado com sucesso');\n        this.redirect();\n      }, error => {\n        this.mensagemService.mensagemError(error, 'Ocorreu um erro ao tentar salvar o ofício');\n      });\n    }\n  }\n  atualizar() {\n    if (this.validaCampos()) {\n      this.oficioService.atualizar(this.oficio).subscribe(() => {\n        this.mensagemService.mensagemSucesso('Registro atualizado com sucesso');\n        this.redirect();\n      }, error => {\n        this.mensagemService.mensagemError(error, 'Erro ao tentar atualizar');\n      });\n    }\n  }\n  redirect() {\n    this.router.navigate(['oficios']);\n  }\n  validaCampos() {\n    if (this.oficio.assinante === undefined || Object.keys(this.oficio.assinante).length === 0) {\n      this.mensagemService.mensagemAlerta('Por favor, informe o vereador');\n      return false;\n    }\n    if (this.oficio.texto === null || this.oficio.texto === undefined) {\n      this.mensagemService.mensagemAlerta('Por favor, informe o texto do ofício');\n      return false;\n    }\n    if (this.oficio.assunto === null || this.oficio.assunto === undefined) {\n      this.mensagemService.mensagemAlerta('Por favor, informe o assunto do ofício');\n      return false;\n    }\n    return true;\n  }\n  findById(oficioId) {\n    this.oficioService.listarPorId(oficioId).subscribe(response => {\n      this.oficio = response;\n    }, error => {\n      this.mensagemService.mensagemError(error, 'Erro ao tentar listar o ofício');\n    });\n  }\n  onTabChange(event) {\n    if (event.index === 1) {\n      this.preview();\n    }\n  }\n  preview() {\n    this.oficioService.preview(this.oficio).subscribe(data => {\n      const file = this.fileService.blobToFile(data, 'Pré-visualização');\n      const url = window.URL.createObjectURL(file);\n      this.pdfSrc = url;\n    }, error => this.mensagemService.mensagemError(error, 'Ocorreu um erro ao tentar exibir o arquivo.'));\n  }\n}\nOficioFormComponent.ɵfac = function OficioFormComponent_Factory(t) {\n  return new (t || OficioFormComponent)(i0.ɵɵdirectiveInject(i1.OficioService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.MensagemService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i4.FileService));\n};\nOficioFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OficioFormComponent,\n  selectors: [[\"app-oficio-form\"]],\n  decls: 62,\n  vars: 26,\n  consts: [[1, \"content-wrapper\", \"mt-4\"], [1, \"content\"], [1, \"container-fluid\"], [1, \"card\", \"card-secondary\"], [1, \"card-header\"], [1, \"card-title\"], [3, \"onChange\"], [\"header\", \"Of\\u00EDcio\", \"leftIcon\", \"fa fa-book\", 3, \"selected\"], [1, \"card-body\"], [1, \"row\"], [1, \"form-group\", \"col-md-2\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"numero\", 1, \"col-md-12\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-group\", \"col-md-3\"], [\"data-target-input\", \"nearest\", 1, \"input-group\", \"date\"], [\"name\", \"dataOficio\", \"view\", \"date\", \"dateFormat\", \"dd/mm/yy\", 1, \"calendar-control\", 3, \"ngModel\", \"showIcon\", \"showButtonBar\", \"yearNavigator\", \"ngModelChange\"], [1, \"form-group\", \"col-md-7\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"destinatario\", 1, \"col-md-10\", 3, \"ngModel\", \"ngModelChange\"], [1, \"row\", \"mt-2\"], [1, \"form-group\", \"col-md-5\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"cargoDestinatario\", 1, \"col-md-9\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"formaTratamentoDestinatario\", 1, \"col-md-9\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"assunto\", 1, \"col-md-10\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"assinante\", \"optionLabel\", \"nome\", \"placeholder\", \"Selecione\", 3, \"options\", \"ngModel\", \"required\", \"ngModelChange\"], [1, \"col-md-10\", \"mt-2\"], [1, \"form-group\"], [\"for\", \"texto\"], [\"name\", \"texto\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn-right\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Salvar\", \"icon\", \"pi pi-save\", 1, \"p-button-success\", \"p-button-sm\", 3, \"click\"], [\"routerLink\", \"../\", \"pButton\", \"\", \"type\", \"button\", \"label\", \"Cancelar\", \"icon\", \"pi pi-angle-left\", 1, \"p-button-secondary\", \"p-button-sm\", \"ml-2\"], [\"header\", \"Pr\\u00E9-visualiza\\u00E7\\u00E3o\", \"leftIcon\", \"pi pi-eye\", 3, \"disabled\"], [1, \"pdf-container\"], [\"id\", \"viewer\", 3, \"src\", \"original-size\", \"zoom\", \"show-borders\"]],\n  template: function OficioFormComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"section\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h3\", 5);\n      i0.ɵɵtext(6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(7, \"p-tabView\", 6);\n      i0.ɵɵlistener(\"onChange\", function OficioFormComponent_Template_p_tabView_onChange_7_listener($event) {\n        return ctx.onTabChange($event);\n      });\n      i0.ɵɵelementStart(8, \"p-tabPanel\", 7)(9, \"form\")(10, \"div\", 8)(11, \"div\", 9)(12, \"div\", 10)(13, \"label\");\n      i0.ɵɵtext(14, \"N\\u00FAmero\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(15, \"br\");\n      i0.ɵɵelementStart(16, \"input\", 11);\n      i0.ɵɵlistener(\"ngModelChange\", function OficioFormComponent_Template_input_ngModelChange_16_listener($event) {\n        return ctx.oficio.numero = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(17, \"div\", 12)(18, \"label\");\n      i0.ɵɵtext(19, \"Data:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"div\", 13)(21, \"p-calendar\", 14);\n      i0.ɵɵlistener(\"ngModelChange\", function OficioFormComponent_Template_p_calendar_ngModelChange_21_listener($event) {\n        return ctx.oficio.dataOficio = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(22, \"div\", 15)(23, \"label\");\n      i0.ɵɵtext(24, \"Destinat\\u00E1rio\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(25, \"br\");\n      i0.ɵɵelementStart(26, \"input\", 16);\n      i0.ɵɵlistener(\"ngModelChange\", function OficioFormComponent_Template_input_ngModelChange_26_listener($event) {\n        return ctx.oficio.destinatario = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(27, \"div\", 17)(28, \"div\", 18)(29, \"label\");\n      i0.ɵɵtext(30, \"Cargo do destinat\\u00E1rio\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(31, \"br\");\n      i0.ɵɵelementStart(32, \"input\", 19);\n      i0.ɵɵlistener(\"ngModelChange\", function OficioFormComponent_Template_input_ngModelChange_32_listener($event) {\n        return ctx.oficio.cargoDestinatario = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(33, \"div\", 18)(34, \"label\");\n      i0.ɵɵtext(35, \"Forma tratamento destinat\\u00E1rio\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(36, \"br\");\n      i0.ɵɵelementStart(37, \"input\", 20);\n      i0.ɵɵlistener(\"ngModelChange\", function OficioFormComponent_Template_input_ngModelChange_37_listener($event) {\n        return ctx.oficio.formaTratamentoDestinatario = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(38, \"div\", 17)(39, \"div\", 15)(40, \"label\");\n      i0.ɵɵtext(41, \"Assunto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(42, \"br\");\n      i0.ɵɵelementStart(43, \"input\", 21);\n      i0.ɵɵlistener(\"ngModelChange\", function OficioFormComponent_Template_input_ngModelChange_43_listener($event) {\n        return ctx.oficio.assunto = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(44, \"div\", 18)(45, \"label\");\n      i0.ɵɵtext(46, \"Assinante\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(47, \"br\");\n      i0.ɵɵelementStart(48, \"p-dropdown\", 22);\n      i0.ɵɵlistener(\"ngModelChange\", function OficioFormComponent_Template_p_dropdown_ngModelChange_48_listener($event) {\n        return ctx.oficio.assinante = $event;\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(49, \"div\", 23)(50, \"div\", 24)(51, \"label\", 25);\n      i0.ɵɵtext(52, \"Texto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(53, \"div\")(54, \"p-editor\", 26);\n      i0.ɵɵlistener(\"ngModelChange\", function OficioFormComponent_Template_p_editor_ngModelChange_54_listener($event) {\n        return ctx.oficio.texto = $event;\n      });\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(55, \"p-footer\")(56, \"div\", 27)(57, \"button\", 28);\n      i0.ɵɵlistener(\"click\", function OficioFormComponent_Template_button_click_57_listener() {\n        return ctx.cadastrar();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(58, \"button\", 29);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(59, \"p-tabPanel\", 30)(60, \"div\", 31);\n      i0.ɵɵelement(61, \"pdf-viewer\", 32);\n      i0.ɵɵelementEnd()()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(6);\n      i0.ɵɵtextInterpolate(ctx.titulo);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"selected\", true);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngModel\", ctx.oficio.numero);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.oficio.dataOficio)(\"showIcon\", true)(\"showButtonBar\", true)(\"yearNavigator\", true);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.oficio.destinatario);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngModel\", ctx.oficio.cargoDestinatario);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.oficio.formaTratamentoDestinatario);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngModel\", ctx.oficio.assunto);\n      i0.ɵɵadvance(5);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(24, _c0));\n      i0.ɵɵproperty(\"options\", ctx.assinanteList)(\"ngModel\", ctx.oficio.assinante)(\"required\", true);\n      i0.ɵɵadvance(6);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(25, _c1));\n      i0.ɵɵproperty(\"ngModel\", ctx.oficio.texto);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"disabled\", ctx.oficio.numero == \"\" || ctx.oficio.assunto == \"\" || ctx.oficio.destinatario == \"\" || ctx.oficio.texto == \"\");\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"src\", ctx.pdfSrc)(\"original-size\", false)(\"zoom\", 0.5)(\"show-borders\", true);\n    }\n  },\n  dependencies: [i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i2.RouterLink, i6.Footer, i7.Dropdown, i5.NgModel, i5.NgForm, i8.Calendar, i9.ButtonDirective, i10.Editor, i11.InputText, i12.TabView, i12.TabPanel, i13.PdfViewerComponent],\n  styles: [\"pdf-viewer[_ngcontent-%COMP%] {\\n  display: block;\\n  height: 100vh;\\n  background-color: rgba(0, 0, 0, 0.2);\\n  padding: 20px 0px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvb2ZpY2lvL29maWNpby1mb3JtL29maWNpby1mb3JtLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBQTtFQUNBLGFBQUE7RUFDQSxvQ0FBQTtFQUNBLGlCQUFBO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJwZGYtdmlld2VyIHtcclxuICBkaXNwbGF5OiBibG9jaztcclxuICBoZWlnaHQ6IDEwMHZoO1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYigwLCAwLCAwLCAwLjIpO1xyXG4gIHBhZGRpbmc6IDIwcHggMHB4O1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["Pessoa","OficioFormComponent","constructor","oficioService","router","mensagemService","activedRoute","fileService","assinante","texto","assunto","numero","dataOficio","Date","destinatario","cargoDestinatario","formaTratamentoDestinatario","ngOnInit","listarVereadores","oficioId","snapshot","paramMap","get","titulo","findById","listarAssinantes","subscribe","response","assinanteList","error","mensagemError","cadastrar","validaCampos","oficio","mensagemSucesso","redirect","atualizar","navigate","undefined","Object","keys","length","mensagemAlerta","listarPorId","onTabChange","event","index","preview","data","file","blobToFile","url","window","URL","createObjectURL","pdfSrc","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\samue\\Documents\\fullstackC\\requerimento-app\\src\\app\\oficio\\oficio-form\\oficio-form.component.ts","C:\\Users\\samue\\Documents\\fullstackC\\requerimento-app\\src\\app\\oficio\\oficio-form\\oficio-form.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { FileService } from 'src/app/service/file.service';\r\nimport { Oficio } from 'src/app/shared/model/oficio.model';\r\nimport { Pessoa } from 'src/app/shared/model/pessoa.model';\r\n\r\nimport { MensagemService } from './../../service/mensagemService';\r\nimport { OficioService } from './../oficio.service';\r\n\r\n@Component({\r\n  selector: 'app-oficio-form',\r\n  templateUrl: './oficio-form.component.html',\r\n  styleUrls: ['./oficio-form.component.scss'],\r\n})\r\nexport class OficioFormComponent implements OnInit {\r\n  assinanteList: Pessoa[];\r\n  titulo = 'Cadastrar ofício';\r\n\r\n  oficio: Oficio = {\r\n    assinante: new Pessoa(),\r\n    texto: '',\r\n    assunto: '',\r\n    numero: '',\r\n    dataOficio: new Date(),\r\n    destinatario: '',\r\n    cargoDestinatario: '',\r\n    formaTratamentoDestinatario: '',\r\n  };\r\n  oficioId: string | null;\r\n  public pdfSrc = '';\r\n\r\n  constructor(\r\n    private oficioService: OficioService,\r\n    private router: Router,\r\n    private mensagemService: MensagemService,\r\n    private activedRoute: ActivatedRoute,\r\n    private fileService: FileService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.listarVereadores();\r\n    this.oficioId = this.activedRoute.snapshot.paramMap.get('id');\r\n    if (this.oficioId !== null) {\r\n      this.titulo = 'Editar ofício';\r\n      this.findById(+this.oficioId);\r\n    }\r\n  }\r\n\r\n  public listarVereadores() {\r\n    this.oficioService.listarAssinantes().subscribe(\r\n      (response: Pessoa[]): void => {\r\n        this.assinanteList = response;\r\n      },\r\n      (error) => {\r\n        this.mensagemService.mensagemError(\r\n          error,\r\n          'Ocorreu um erro ao tentar listar os assinantes!'\r\n        );\r\n      }\r\n    );\r\n  }\r\n\r\n  cadastrar(): void {\r\n    if (this.validaCampos()) {\r\n      this.oficioService.cadastrar(this.oficio).subscribe(\r\n        () => {\r\n          this.mensagemService.mensagemSucesso(\r\n            'Cadastro realizado com sucesso'\r\n          );\r\n          this.redirect();\r\n        },\r\n        (error) => {\r\n          this.mensagemService.mensagemError(\r\n            error,\r\n            'Ocorreu um erro ao tentar salvar o ofício'\r\n          );\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  atualizar(): void {\r\n    if (this.validaCampos()) {\r\n      this.oficioService.atualizar(this.oficio).subscribe(\r\n        () => {\r\n          this.mensagemService.mensagemSucesso(\r\n            'Registro atualizado com sucesso'\r\n          );\r\n          this.redirect();\r\n        },\r\n        (error) => {\r\n          this.mensagemService.mensagemError(error, 'Erro ao tentar atualizar');\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  private redirect() {\r\n    this.router.navigate(['oficios']);\r\n  }\r\n\r\n  private validaCampos(): boolean {\r\n    if (\r\n      this.oficio.assinante === undefined ||\r\n      Object.keys(this.oficio.assinante).length === 0\r\n    ) {\r\n      this.mensagemService.mensagemAlerta('Por favor, informe o vereador');\r\n      return false;\r\n    }\r\n\r\n    if (this.oficio.texto === null || this.oficio.texto === undefined) {\r\n      this.mensagemService.mensagemAlerta(\r\n        'Por favor, informe o texto do ofício'\r\n      );\r\n      return false;\r\n    }\r\n\r\n    if (this.oficio.assunto === null || this.oficio.assunto === undefined) {\r\n      this.mensagemService.mensagemAlerta(\r\n        'Por favor, informe o assunto do ofício'\r\n      );\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private findById(oficioId: number): void {\r\n    this.oficioService.listarPorId(oficioId).subscribe(\r\n      (response) => {\r\n        this.oficio = response;\r\n      },\r\n      (error) => {\r\n        this.mensagemService.mensagemError(\r\n          error,\r\n          'Erro ao tentar listar o ofício'\r\n        );\r\n      }\r\n    );\r\n  }\r\n\r\n  onTabChange(event: any) {\r\n    if (event.index === 1) {\r\n      this.preview();\r\n    }\r\n  }\r\n\r\n  preview() {\r\n    this.oficioService.preview(this.oficio).subscribe(\r\n      (data) => {\r\n        const file = this.fileService.blobToFile(data, 'Pré-visualização');\r\n        const url = window.URL.createObjectURL(file);\r\n        this.pdfSrc = url;\r\n      },\r\n      (error) =>\r\n        this.mensagemService.mensagemError(\r\n          error,\r\n          'Ocorreu um erro ao tentar exibir o arquivo.'\r\n        )\r\n    );\r\n  }\r\n}\r\n","<div class=\"content-wrapper mt-4\">\r\n  <section class=\"content\">\r\n    <div class=\"container-fluid\">\r\n\r\n      <div class=\"card card-secondary\">\r\n        <div class=\"card-header\">\r\n          <h3 class=\"card-title\">{{ titulo }}</h3>\r\n        </div>\r\n        <p-tabView (onChange)=\"onTabChange($event)\">\r\n          <p-tabPanel header=\"Ofício\" [selected]=\"true\" leftIcon=\"fa fa-book\">\r\n            <form>\r\n              <div class=\"card-body\">\r\n                <div class=\"row\">\r\n\r\n                  <div class=\"form-group col-md-2\">\r\n                    <label>Número</label>\r\n                    <br>\r\n                    <input type=\"text\" pInputText [(ngModel)]=\"oficio.numero\" name=\"numero\" class=\"col-md-12\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-3\">\r\n                    <label>Data:</label>\r\n                    <div class=\"input-group date\" data-target-input=\"nearest\">\r\n                      <p-calendar [(ngModel)]=\"oficio.dataOficio\" name=\"dataOficio\" class=\"calendar-control\" view=\"date\"\r\n                        dateFormat=\"dd/mm/yy\" [showIcon]=\"true\" [showButtonBar]=\"true\" [yearNavigator]=\"true\">\r\n                      </p-calendar>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-7\">\r\n                    <label>Destinatário</label>\r\n                    <br>\r\n                    <input type=\"text\" pInputText [(ngModel)]=\"oficio.destinatario\" name=\"destinatario\"\r\n                      class=\"col-md-10\" />\r\n                  </div>\r\n                </div>\r\n                <!-- /.form-group -->\r\n                <div class=\"row mt-2\">\r\n\r\n                  <div class=\"form-group col-md-5\">\r\n                    <label>Cargo do destinatário</label>\r\n                    <br>\r\n                    <input type=\"text\" pInputText [(ngModel)]=\"oficio.cargoDestinatario\" name=\"cargoDestinatario\"\r\n                      class=\"col-md-9\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-5\">\r\n                    <label>Forma tratamento destinatário</label>\r\n                    <br>\r\n                    <input type=\"text\" pInputText [(ngModel)]=\"oficio.formaTratamentoDestinatario\"\r\n                      name=\"formaTratamentoDestinatario\" class=\"col-md-9\" />\r\n                  </div>\r\n                </div>\r\n                <div class=\"row mt-2\">\r\n                  <div class=\"form-group col-md-7\">\r\n                    <label>Assunto</label>\r\n                    <br>\r\n                    <input type=\"text\" pInputText [(ngModel)]=\"oficio.assunto\" name=\"assunto\" class=\"col-md-10\" />\r\n                  </div>\r\n\r\n                  <div class=\"form-group col-md-5\">\r\n                    <label>Assinante</label>\r\n                    <br>\r\n                    <p-dropdown [options]=\"assinanteList\" [(ngModel)]=\"oficio.assinante\" name=\"assinante\"\r\n                      optionLabel=\"nome\" placeholder=\"Selecione\" [required]=\"true\" [style]=\"{'width':'400px'}\">\r\n                    </p-dropdown>\r\n                  </div>\r\n\r\n                  <!-- /.col -->\r\n                  <div class=\"col-md-10 mt-2\">\r\n                    <div class=\"form-group\">\r\n                      <label for=\"texto\">Texto</label>\r\n                      <div>\r\n                        <p-editor [style]=\"{'height':'120px','font-size':'16px'}\" [(ngModel)]=\"oficio.texto\"\r\n                          name=\"texto\" required>\r\n                        </p-editor>\r\n                      </div>\r\n                    </div>\r\n\r\n                  </div>\r\n                </div>\r\n                <p-footer>\r\n                  <div class=\"btn-right\">\r\n                    <button (click)=\"cadastrar()\" pButton type=\"button\" label=\"Salvar\" icon=\"pi pi-save\"\r\n                      class=\"p-button-success p-button-sm\"></button>\r\n                    <button routerLink=\"../\" pButton type=\"button\" label=\"Cancelar\" icon=\"pi pi-angle-left\"\r\n                      class=\"p-button-secondary p-button-sm ml-2\"></button>\r\n                  </div>\r\n                </p-footer>\r\n                <!-- /.col -->\r\n              </div>\r\n            </form>\r\n          </p-tabPanel>\r\n          <p-tabPanel header=\"Pré-visualização\" leftIcon=\"pi pi-eye\" [disabled]=\"oficio.numero == ''  || oficio.assunto == ''  || oficio.destinatario == ''\r\n                || oficio.texto == ''\">\r\n            <div class=\"pdf-container\">\r\n              <pdf-viewer [src]=\"pdfSrc\" id=\"viewer\" [original-size]=\"false\" [zoom]=\"0.5\" [show-borders]=\"true\">\r\n              </pdf-viewer>\r\n            </div>\r\n          </p-tabPanel>\r\n        </p-tabView>\r\n\r\n      </div>\r\n\r\n    </div>\r\n\r\n  </section>\r\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}