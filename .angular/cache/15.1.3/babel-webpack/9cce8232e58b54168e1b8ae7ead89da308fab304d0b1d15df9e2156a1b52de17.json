{"ast":null,"code":"import { Pessoa } from '../../shared/model/pessoa.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./../requerimento.service\";\nimport * as i2 from \"../../vereadores/vereadores.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app/service/mensagemService\";\nimport * as i5 from \"src/app/service/file.service\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"primeng/api\";\nimport * as i8 from \"primeng/dropdown\";\nimport * as i9 from \"primeng/calendar\";\nimport * as i10 from \"primeng/button\";\nimport * as i11 from \"primeng/editor\";\nimport * as i12 from \"primeng/inputtext\";\nimport * as i13 from \"primeng/tabview\";\nimport * as i14 from \"ng2-pdf-viewer\";\nconst _c0 = function () {\n  return {\n    \"width\": \"305px\"\n  };\n};\nconst _c1 = function () {\n  return {\n    \"height\": \"120px\",\n    \"font-size\": \"16px\"\n  };\n};\nexport class RequerimentoFormComponent {\n  constructor(requerimentoService, vereadorService, router, mensagemService, activedRoute, fileService) {\n    this.requerimentoService = requerimentoService;\n    this.vereadorService = vereadorService;\n    this.router = router;\n    this.mensagemService = mensagemService;\n    this.activedRoute = activedRoute;\n    this.fileService = fileService;\n    this.titulo = 'Cadastrar requerimento';\n    this.requerimento = {\n      pessoa: new Pessoa(),\n      assunto: '',\n      numero: '',\n      dataRequerimento: new Date()\n    };\n    this.pdfSrc = '';\n  }\n  ngOnInit() {\n    this.listarVereadores();\n    this.requerimentoId = this.activedRoute.snapshot.paramMap.get('id');\n    if (this.requerimentoId !== null) {\n      this.titulo = 'Editar requerimento';\n      this.findById(+this.requerimentoId);\n    }\n  }\n  listarVereadores() {\n    this.vereadorService.listarTodos().subscribe(response => {\n      this.vereadorList = response;\n    }, error => {\n      this.mensagemService.mensagemError(error, 'Erro ao tentar listar os vereadores');\n    });\n  }\n  cadastrar() {\n    if (this.validaCampos()) {\n      this.requerimentoService.cadastrar(this.requerimento).subscribe(() => {\n        this.mensagemService.mensagemSucesso('Cadastro realizado com sucesso');\n        this.redirect();\n      }, error => {\n        this.mensagemService.mensagemError(error, 'Ocorreu um erro ao tentar salvar o requerimento');\n      });\n    }\n  }\n  atualizar() {\n    if (this.validaCampos()) {\n      this.requerimentoService.atualizar(this.requerimento).subscribe(() => {\n        this.mensagemService.mensagemSucesso('Registro atualizado com sucesso');\n        this.redirect();\n      }, error => {\n        this.mensagemService.mensagemError(error, 'Erro ao tentar atualizar');\n      });\n    }\n  }\n  redirect() {\n    this.router.navigate(['requerimentos']);\n  }\n  validaCampos() {\n    if (this.requerimento.pessoa === undefined || Object.keys(this.requerimento.pessoa).length === 0) {\n      this.mensagemService.mensagemAlerta('Por favor, informe o vereador');\n      return false;\n    }\n    if (this.requerimento.assunto === null || this.requerimento.assunto === undefined) {\n      this.mensagemService.mensagemAlerta('Por favor, informe o assunto do requerimento');\n      return false;\n    }\n    return true;\n  }\n  findById(requerimentoId) {\n    this.requerimentoService.listarPorId(requerimentoId).subscribe(response => {\n      this.requerimento = response;\n    }, error => {\n      this.mensagemService.mensagemError(error, 'Erro ao tentar listar o requerimento');\n    });\n  }\n  onTabChange(event) {\n    if (event.index === 1) {\n      this.preview();\n    }\n  }\n  preview() {\n    this.requerimentoService.preview(this.requerimento).subscribe(data => {\n      const file = this.fileService.blobToFile(data, 'Pré-visualização');\n      const url = window.URL.createObjectURL(file);\n      this.pdfSrc = url;\n    }, error => this.mensagemService.mensagemError(error, 'Ocorreu um erro ao tentar exibir o arquivo.'));\n  }\n}\nRequerimentoFormComponent.ɵfac = function RequerimentoFormComponent_Factory(t) {\n  return new (t || RequerimentoFormComponent)(i0.ɵɵdirectiveInject(i1.RequerimentoService), i0.ɵɵdirectiveInject(i2.VereadoresService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.MensagemService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i5.FileService));\n};\nRequerimentoFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: RequerimentoFormComponent,\n  selectors: [[\"app-requerimento-form\"]],\n  decls: 42,\n  vars: 22,\n  consts: [[1, \"content-wrapper\", \"mt-4\"], [1, \"content\"], [1, \"container-fluid\"], [1, \"card\", \"card-secondary\"], [1, \"card-header\"], [1, \"card-title\"], [3, \"onChange\"], [\"header\", \"Requerimento\", \"leftIcon\", \"fa fa-book\", 3, \"selected\"], [1, \"card-body\"], [1, \"row\"], [1, \"col-md-6\"], [1, \"form-group\"], [\"type\", \"text\", \"pInputText\", \"\", \"name\", \"numero\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"pessoa\", \"optionLabel\", \"nome\", \"placeholder\", \"Selecione\", 3, \"options\", \"ngModel\", \"required\", \"ngModelChange\"], [1, \"form-group\", \"col-md-4\"], [\"data-target-input\", \"nearest\", 1, \"input-group\", \"date\"], [\"name\", \"dataRequerimento\", \"view\", \"date\", \"dateFormat\", \"dd/mm/yy\", 1, \"calendar-control\", 3, \"ngModel\", \"showIcon\", \"showButtonBar\", \"yearNavigator\", \"ngModelChange\"], [1, \"col-md-10\"], [\"for\", \"texto\"], [\"name\", \"assunto\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn-right\"], [\"pButton\", \"\", \"type\", \"button\", \"label\", \"Salvar\", \"icon\", \"pi pi-save\", 1, \"p-button-success\", \"p-button-sm\", 3, \"click\"], [\"routerLink\", \"../\", \"pButton\", \"\", \"type\", \"button\", \"label\", \"Cancelar\", \"icon\", \"pi pi-angle-left\", 1, \"p-button-secondary\", \"p-button-sm\", \"ml-2\"], [\"header\", \"Pr\\u00E9-visualiza\\u00E7\\u00E3o\", \"leftIcon\", \"pi pi-eye\", 3, \"disabled\"], [1, \"pdf-container\"], [\"id\", \"viewer\", 3, \"src\", \"original-size\", \"zoom\", \"show-borders\"]],\n  template: function RequerimentoFormComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"section\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"h3\", 5);\n      i0.ɵɵtext(6);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(7, \"p-tabView\", 6);\n      i0.ɵɵlistener(\"onChange\", function RequerimentoFormComponent_Template_p_tabView_onChange_7_listener($event) {\n        return ctx.onTabChange($event);\n      });\n      i0.ɵɵelementStart(8, \"p-tabPanel\", 7)(9, \"form\")(10, \"div\", 8)(11, \"div\", 9)(12, \"div\", 10)(13, \"div\", 11)(14, \"label\");\n      i0.ɵɵtext(15, \"N\\u00FAmero\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(16, \"br\");\n      i0.ɵɵelementStart(17, \"input\", 12);\n      i0.ɵɵlistener(\"ngModelChange\", function RequerimentoFormComponent_Template_input_ngModelChange_17_listener($event) {\n        return ctx.requerimento.numero = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(18, \"div\", 10)(19, \"div\", 11)(20, \"label\");\n      i0.ɵɵtext(21, \"Vereador\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(22, \"br\");\n      i0.ɵɵelementStart(23, \"p-dropdown\", 13);\n      i0.ɵɵlistener(\"ngModelChange\", function RequerimentoFormComponent_Template_p_dropdown_ngModelChange_23_listener($event) {\n        return ctx.requerimento.pessoa = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(24, \"div\", 14)(25, \"label\");\n      i0.ɵɵtext(26, \"Data:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(27, \"div\", 15)(28, \"p-calendar\", 16);\n      i0.ɵɵlistener(\"ngModelChange\", function RequerimentoFormComponent_Template_p_calendar_ngModelChange_28_listener($event) {\n        return ctx.requerimento.dataRequerimento = $event;\n      });\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(29, \"div\", 17)(30, \"div\", 11)(31, \"label\", 18);\n      i0.ɵɵtext(32, \"Assunto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(33, \"div\")(34, \"p-editor\", 19);\n      i0.ɵɵlistener(\"ngModelChange\", function RequerimentoFormComponent_Template_p_editor_ngModelChange_34_listener($event) {\n        return ctx.requerimento.assunto = $event;\n      });\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(35, \"p-footer\")(36, \"div\", 20)(37, \"button\", 21);\n      i0.ɵɵlistener(\"click\", function RequerimentoFormComponent_Template_button_click_37_listener() {\n        return ctx.cadastrar();\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(38, \"button\", 22);\n      i0.ɵɵelementEnd()()()()();\n      i0.ɵɵelementStart(39, \"p-tabPanel\", 23)(40, \"div\", 24);\n      i0.ɵɵelement(41, \"pdf-viewer\", 25);\n      i0.ɵɵelementEnd()()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(6);\n      i0.ɵɵtextInterpolate(ctx.titulo);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"selected\", true);\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"ngModel\", ctx.requerimento.numero);\n      i0.ɵɵadvance(6);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(20, _c0));\n      i0.ɵɵproperty(\"options\", ctx.vereadorList)(\"ngModel\", ctx.requerimento.pessoa)(\"required\", true);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"ngModel\", ctx.requerimento.dataRequerimento)(\"showIcon\", true)(\"showButtonBar\", true)(\"yearNavigator\", true);\n      i0.ɵɵadvance(6);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(21, _c1));\n      i0.ɵɵproperty(\"ngModel\", ctx.requerimento.assunto);\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"disabled\", ctx.requerimento.numero == \"\" || ctx.requerimento.assunto == \"\" && ctx.requerimento.pessoa == null);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"src\", ctx.pdfSrc)(\"original-size\", false)(\"zoom\", 0.5)(\"show-borders\", true);\n    }\n  },\n  dependencies: [i6.ɵNgNoValidate, i6.DefaultValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.RequiredValidator, i3.RouterLink, i7.Footer, i8.Dropdown, i6.NgModel, i6.NgForm, i9.Calendar, i10.ButtonDirective, i11.Editor, i12.InputText, i13.TabView, i13.TabPanel, i14.PdfViewerComponent],\n  styles: [\"pdf-viewer[_ngcontent-%COMP%] {\\n  display: block;\\n  height: 100vh;\\n  background-color: rgba(0, 0, 0, 0.2);\\n  padding: 20px 0px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcmVxdWVyaW1lbnRvL3JlcXVlcmltZW50by1mb3JtL3JlcXVlcmltZW50by1mb3JtLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsY0FBQTtFQUNBLGFBQUE7RUFDQSxvQ0FBQTtFQUNBLGlCQUFBO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJwZGYtdmlld2VyIHtcclxuICBkaXNwbGF5OiBibG9jaztcclxuICBoZWlnaHQ6IDEwMHZoO1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYigwLCAwLCAwLCAwLjIpO1xyXG4gIHBhZGRpbmc6IDIwcHggMHB4O1xyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["Pessoa","RequerimentoFormComponent","constructor","requerimentoService","vereadorService","router","mensagemService","activedRoute","fileService","pessoa","assunto","numero","dataRequerimento","Date","ngOnInit","listarVereadores","requerimentoId","snapshot","paramMap","get","titulo","findById","listarTodos","subscribe","response","vereadorList","error","mensagemError","cadastrar","validaCampos","requerimento","mensagemSucesso","redirect","atualizar","navigate","undefined","Object","keys","length","mensagemAlerta","listarPorId","onTabChange","event","index","preview","data","file","blobToFile","url","window","URL","createObjectURL","pdfSrc","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\samue\\Documents\\fullstackC\\requerimento-app\\src\\app\\requerimento\\requerimento-form\\requerimento-form.component.ts","C:\\Users\\samue\\Documents\\fullstackC\\requerimento-app\\src\\app\\requerimento\\requerimento-form\\requerimento-form.component.html"],"sourcesContent":["import { Vereador } from './../../shared/model/vereador.model';\nimport { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { VereadoresService } from '../../vereadores/vereadores.service';\nimport { Pessoa } from '../../shared/model/pessoa.model';\nimport { Requerimento } from '../../shared/model/requerimento.model';\nimport { RequerimentoService } from './../requerimento.service';\nimport { MensagemService } from 'src/app/service/mensagemService';\nimport { FileService } from 'src/app/service/file.service';\n\n@Component({\n  selector: 'app-requerimento-form',\n  templateUrl: './requerimento-form.component.html',\n  styleUrls: ['./requerimento-form.component.scss'],\n})\nexport class RequerimentoFormComponent implements OnInit {\n  vereadorList: Vereador[];\n  titulo = 'Cadastrar requerimento';\n\n  requerimento: Requerimento = {\n    pessoa: new Pessoa(),\n    assunto: '',\n    numero: '',\n    dataRequerimento: new Date(),\n  };\n  requerimentoId: string | null;\n  public pdfSrc = '';\n\n  constructor(\n    private requerimentoService: RequerimentoService,\n    private vereadorService: VereadoresService,\n    private router: Router,\n    private mensagemService: MensagemService,\n    private activedRoute: ActivatedRoute,\n    private fileService: FileService\n  ) {}\n\n  ngOnInit(): void {\n    this.listarVereadores();\n    this.requerimentoId = this.activedRoute.snapshot.paramMap.get('id');\n    if (this.requerimentoId !== null) {\n      this.titulo = 'Editar requerimento';\n      this.findById(+this.requerimentoId);\n    }\n  }\n\n  public listarVereadores() {\n    this.vereadorService.listarTodos().subscribe(\n      (response: Vereador[]): void => {\n        this.vereadorList = response;\n      },\n      (error) => {\n        this.mensagemService.mensagemError(\n          error,\n          'Erro ao tentar listar os vereadores'\n        );\n      }\n    );\n  }\n\n  cadastrar(): void {\n    if (this.validaCampos()) {\n      this.requerimentoService.cadastrar(this.requerimento).subscribe(\n        () => {\n          this.mensagemService.mensagemSucesso(\n            'Cadastro realizado com sucesso'\n          );\n          this.redirect();\n        },\n        (error) => {\n          this.mensagemService.mensagemError(\n            error,\n            'Ocorreu um erro ao tentar salvar o requerimento'\n          );\n        }\n      );\n    }\n  }\n\n  atualizar(): void {\n    if (this.validaCampos()) {\n      this.requerimentoService.atualizar(this.requerimento).subscribe(\n        () => {\n          this.mensagemService.mensagemSucesso(\n            'Registro atualizado com sucesso'\n          );\n          this.redirect();\n        },\n        (error) => {\n          this.mensagemService.mensagemError(error, 'Erro ao tentar atualizar');\n        }\n      );\n    }\n  }\n\n  private redirect() {\n    this.router.navigate(['requerimentos']);\n  }\n\n  private validaCampos(): boolean {\n    if (\n      this.requerimento.pessoa === undefined ||\n      Object.keys(this.requerimento.pessoa).length === 0\n    ) {\n      this.mensagemService.mensagemAlerta('Por favor, informe o vereador');\n      return false;\n    }\n\n    if (\n      this.requerimento.assunto === null ||\n      this.requerimento.assunto === undefined\n    ) {\n      this.mensagemService.mensagemAlerta(\n        'Por favor, informe o assunto do requerimento'\n      );\n      return false;\n    }\n    return true;\n  }\n\n  private findById(requerimentoId: number): void {\n    this.requerimentoService.listarPorId(requerimentoId).subscribe(\n      (response) => {\n        this.requerimento = response;\n      },\n      (error) => {\n        this.mensagemService.mensagemError(\n          error,\n          'Erro ao tentar listar o requerimento'\n        );\n      }\n    );\n  }\n\n  onTabChange(event: any) {\n    if (event.index === 1) {\n      this.preview();\n    }\n  }\n\n  preview() {\n    this.requerimentoService.preview(this.requerimento).subscribe(\n      (data) => {\n        const file = this.fileService.blobToFile(data, 'Pré-visualização');\n        const url = window.URL.createObjectURL(file);\n        this.pdfSrc = url;\n      },\n      (error) =>\n        this.mensagemService.mensagemError(\n          error,\n          'Ocorreu um erro ao tentar exibir o arquivo.'\n        )\n    );\n  }\n}\n","<div class=\"content-wrapper mt-4\">\r\n  <section class=\"content\">\r\n    <div class=\"container-fluid\">\r\n\r\n      <div class=\"card card-secondary\">\r\n        <div class=\"card-header\">\r\n          <h3 class=\"card-title\">{{ titulo }}</h3>\r\n        </div>\r\n        <p-tabView (onChange)=\"onTabChange($event)\">\r\n          <p-tabPanel header=\"Requerimento\" [selected]=\"true\" leftIcon=\"fa fa-book\">\r\n            <form>\r\n              <div class=\"card-body\">\r\n                <div class=\"row\">\r\n                  <div class=\"col-md-6\">\r\n                    <div class=\"form-group\">\r\n                      <label>Número</label>\r\n                      <br>\r\n                      <input type=\"text\" pInputText [(ngModel)]=\"requerimento.numero\" name=\"numero\" />\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"col-md-6\">\r\n                    <div class=\"form-group\">\r\n                      <label>Vereador</label>\r\n                      <br>\r\n                      <p-dropdown [options]=\"vereadorList\" [(ngModel)]=\"requerimento.pessoa\" name=\"pessoa\"\r\n                        optionLabel=\"nome\" placeholder=\"Selecione\" [required]=\"true\" [style]=\"{'width':'305px'}\">\r\n                      </p-dropdown>\r\n                    </div>\r\n                  </div>\r\n                  <!-- /.form-group -->\r\n                  <div class=\"form-group col-md-4\">\r\n                    <label>Data:</label>\r\n                    <div class=\"input-group date\" data-target-input=\"nearest\">\r\n                      <p-calendar [(ngModel)]=\"requerimento.dataRequerimento\" name=\"dataRequerimento\"\r\n                        class=\"calendar-control\" view=\"date\" dateFormat=\"dd/mm/yy\" [showIcon]=\"true\"\r\n                        [showButtonBar]=\"true\" [yearNavigator]=\"true\">\r\n                      </p-calendar>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <!-- /.col -->\r\n                  <div class=\"col-md-10\">\r\n                    <div class=\"form-group\">\r\n                      <label for=\"texto\">Assunto</label>\r\n                      <div>\r\n                        <p-editor [style]=\"{'height':'120px','font-size':'16px'}\" [(ngModel)]=\"requerimento.assunto\"\r\n                          name=\"assunto\" required>\r\n\r\n                        </p-editor>\r\n                      </div>\r\n                    </div>\r\n\r\n                  </div>\r\n                </div>\r\n                <p-footer>\r\n                  <div class=\"btn-right\">\r\n                    <button (click)=\"cadastrar()\" pButton type=\"button\" label=\"Salvar\" icon=\"pi pi-save\"\r\n                      class=\"p-button-success p-button-sm\"></button>\r\n                    <button routerLink=\"../\" pButton type=\"button\" label=\"Cancelar\" icon=\"pi pi-angle-left\"\r\n                      class=\"p-button-secondary p-button-sm ml-2\"></button>\r\n                  </div>\r\n                </p-footer>\r\n                <!-- /.col -->\r\n              </div>\r\n            </form>\r\n          </p-tabPanel>\r\n          <p-tabPanel header=\"Pré-visualização\" leftIcon=\"pi pi-eye\"\r\n            [disabled]=\"requerimento.numero == '' || requerimento.assunto == ''  && requerimento.pessoa == null\">\r\n            <div class=\"pdf-container\">\r\n              <pdf-viewer [src]=\"pdfSrc\" id=\"viewer\" [original-size]=\"false\" [zoom]=\"0.5\" [show-borders]=\"true\">\r\n              </pdf-viewer>\r\n            </div>\r\n          </p-tabPanel>\r\n        </p-tabView>\r\n\r\n      </div>\r\n\r\n    </div>\r\n\r\n  </section>\r\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}